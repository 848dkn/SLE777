---
title: "R markdown report"
author: "Bui Thai Hai Tran, Chelsey Marie Maceren Medina, Choudhary Simran"
date: "2024-10-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Part 1: Gene Expression and Growth Data Analysis
## 1.1 Read and Display Gene Expression Data
```{r install_packages, echo=FALSE, eval=FALSE}
#download required packages 
install.packages("ggplot2")
install.packages("dplyr")
install.packages("tidyr")

#download required files
download.file("https://raw.githubusercontent.com/ghazkha/Assessment4/refs/heads/main/gene_expression.tsv", destfile = "gene_expression.tsv")
download.file("https://raw.githubusercontent.com/ghazkha/Assessment4/refs/heads/main/growth_data.csv", destfile = "growth_data.csv")
```

```{r load_and_print_table, echo=FALSE}
# reading the file into R
gene_expression <- read.delim("gene_expression.tsv", header = TRUE, row.names = 1)
# displaying the first six rows
first6row <- head(gene_expression, n = 6)
knitr::kable(first6row)
```


The result shown is a gene expression table, in which the first row is the title of the biological samples from the GTEx (Genotype-Tissue Expression) project. For example, sample codes such as GTEX.1117F.0226.SM.5GZZ7, GTEX.1117F.0426.SM.5EGHI, and GTEX.1117F.0526.SM.5EGHJ represent biological samples from donors, corresponding to different conditions or tissues. The first column contains the ENSG identifiers (Ensembl Gene IDs) of the genes, such as ENSG00000223972.5 (DDX11L1) and ENSG00000227232.5 (WASH7P), which are used to identify the genes in the Ensembl database.
The cells in the table contain the gene expression values. These values indicate the level of expression of each gene in each sample. For example, row 1 shows that the DDX11L1 gene is not expressed in all samples (value = 0). Row 2 shows that the WASH7P gene is highly expressed in the second sample (value = 187) and third sample (143), but not expressed in the first sample (value = 0). This table illustrates the differences in gene expression levels between biological samples, suggesting that gene expression may depend on tissue type, biological conditions, or other factors.


## 1.2 Adding a new column for the mean of other columns
```{r mean_of_columns, echo=FALSE}
#give the mean of expression values a name
meanofrow <- rowMeans(gene_expression) 
#adding new column into table
gene_expression$Mean_Expression <- meanofrow 
#show a table of values for the first six genes
table_of_values <- head(gene_expression, 6)

knitr::kable(table_of_values) 
```

The results are the output of the R code you executed to analyze the gene expression data. For example, for the gene ENSG00000227232.5_WASH7P, the expression levels in the first three samples were 187, 109, and 143, respectively, with a Mean of 146.33. Other genes showed varying expression levels across samples, with some genes not expressed in all samples, such as ENSG00000223972.5_DDX11L1 and ENSG00000237613.2_FAM138A, resulting in a mean of 0. The practical significance of this result is important in analyzing gene expression patterns, as the mean provides a simple overview of the expression level of each gene across many different samples. This is useful in biological analyses such as identifying genes that are significantly expressed under specific conditions or in certain tissues. Overall, this data table allows for a clear comparison of the expression levels of genes and their average values. 


## 1.3 List the 10 genes with the highest mean expression

```{r list_10_genes, echo=FALSE}
#sort by Mean_Expression and list top 10 in a table 
top_genes <- gene_expression[order(-gene_expression$Mean_Expression), ]
table_of_top10 <- top_genes[1:10, ]
knitr::kable(table_of_top10)
```

The results shown in table in section 1.3 provide information on the 10 genes with the highest mean expression, with the Mean_Expression value indicating the activity level of each gene in the samples. The most highly expressed gene is ENSG00000198804.2_MT-CO1, with a mean value of 529317.3. These genes, such as MT-CO1  and MT-ND4, are mitochondrial genes and may play an important role in biological processes. This list can aid in studying the function and role of these genes in specific diseases or conditions. 


## 1.4 Determine the number of genes with a mean <10

```{r gene_mean_<_10, echo=FALSE}
#count and save number of genes with Mean_Expression < 10 as a value
low_expression_genes <- sum(gene_expression$Mean_Expression < 10)
knitr::kable(low_expression_genes)

```

The results showed that there were 35,988 genes in the dataset with a mean expression value (Mean_Expression) of less than 10. Determining the number of these genes helps researchers identify genes with low expression levels. 

## 1.5  Plot Histogram of Mean Expression

```{r plot_histogram_of_mean, echo=FALSE}
#plot package
library(ggplot2)
#Apply a log10 transformation to the Mean Expression for better visualization
#Added +1 to avoid log of zero
ggplot(gene_expression, aes(x = log10(Mean_Expression + 1))) +  
  geom_histogram(binwidth = 0.1, fill = "blue", color = "black") +
  labs(title = "Histogram of Log10 Mean Gene Expression", x = "Log10 Mean Expression", y = "Frequency") +  theme_minimal()

```

The histogram of Log10 Mean Gene Expression shows the distribution of gene expression levels. The X-axis represents the Log10 value of the mean gene expression, and the Y-axis represents the frequency of genes relative to the expression level. This histogram shows an uneven distribution of gene expression levels, with most genes having low expression levels.

## 1.6 Import Tree Circumference Growth Data and display column names
```{r import_and_display, echo=FALSE}
#reading the CSV file
growth_data <- read.csv("growth_data.csv")
# view column names in console
colnames(growth_data)

```

## 1.7 Calculate the mean and standard deviation of tree circumference

```{r mean_standard_deviation, echo=FALSE, message=FALSE, warning=FALSE} 
#load necessary libraries
library(dplyr)
#calculate the mean and standard deviation of tree circumferences at the start (2005) and end (2020) of the study for both control and treatment sites
summary_stats <- growth_data %>%
  group_by(Site) %>%
  summarise(
    Mean_Circumf_2005 = mean(Circumf_2005_cm, na.rm = TRUE),
    SD_Circumf_2005 = sd(Circumf_2005_cm, na.rm = TRUE),
    Mean_Circumf_2020 = mean(Circumf_2020_cm, na.rm = TRUE),
    SD_Circumf_2020 = sd(Circumf_2020_cm, na.rm = TRUE)  )
#print the summary statistics
knitr::kable(summary_stats)
```

## 1.8 Box plot of tree circumference at the start and end of the study at both sites

```{r box_plot_tree, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary libraries
library(dplyr)
library(tidyr)
library(ggplot2)
#gather the data for Circumf_2005_cm and Circumf_2020_cm into long format
long_data <- growth_data %>%
  select(Site, Circumf_2005_cm, Circumf_2020_cm) %>%
  pivot_longer(cols = starts_with("Circumf"), 
               names_to = "Year", 
               values_to = "Circumference")
#create the box plot
ggplot(long_data, aes(x = Year, y = Circumference, fill = Site)) +
  geom_boxplot() +
  labs(title = "Box Plot of Tree Circumference at Start and End of Study At Both Sites",
       x = "Year",
       y = "Tree Circumference (cm)") +
  scale_x_discrete(labels = c("Circumf_2005_cm" = "2005", "Circumf_2020_cm" = "2020")) +  theme_minimal()
```  

The resulting table in 1.7 shows the change in tree circumference between 2005 and 2020, divided by northeast and southwest. Over the 15 years, the average tree circumference increased significantly in both locations, with the northeast increasing from 5,292 cm to 54,228 cm and the southwest increasing from 4,862 cm to 45,596 cm. The northeast region consistently had a larger average circumference than the southwest. The standard deviation in 2020 was also much higher than in 2005, indicating that the variation in tree size had increased. This is also reflected in the box plot in 1.8, with the average tree circumference at both locations, northeast and southwest, in 2005 being low, below 10 cm, with little variation. However, by 2020, the average tree circumference had increased significantly in both locations. The northeast region had a larger average circumference and greater variation in tree circumference. In contrast, the southwest region had a slightly lower average circumference and less variation, but still had significant growth. In particular, the southwest region had one outlier, showing a tree with a significantly larger circumference than most other trees.

## 1.9 Calculation of the mean growth over the last 10 years at each site

```{r mean_growth_over_10, echo=FALSE}
#calculate the growth for each tree
growth_data <- growth_data %>%
  mutate(Growthover10years = Circumf_2020_cm - Circumf_2010_cm)  #mutate add a new column that contain calculation

#calculate the mean growth at each site
mean_growth <- growth_data %>%
  group_by(Site) %>%
  summarise(Mean_Growth = mean(Growthover10years))  # Compute mean growth
#print the mean growth
knitr::kable(mean_growth)
```

## 1.10 Perform a t-test to estimate the p-value
```{r t_test, echo=FALSE, message=FALSE, warning=FALSE}
#perform t-test to compare the growth between the two sites
t_test_result <- t.test(Growthover10years ~ Site, data = growth_data)

# Extract the t-test results into a data frame
t_test_summary <- data.frame(
  Statistic = t_test_result$statistic,
  P_Value = t_test_result$p.value,
  Conf_Interval_Lower = t_test_result$conf.int[1],
  Conf_Interval_Upper = t_test_result$conf.int[2],
  Mean_Difference = t_test_result$estimate[1] - t_test_result$estimate[2]
)

# Print the t-test results using knitr::kable
knitr::kable(t_test_summary, caption = "T-Test Results: Growth Over 10 Years Between Sites")

```

The table in section 1.9 shows the average growth of tree girth from 2010 to 2020 in each region, with trees in the northeast region having higher average growth than those in the southwest.

The table in section 1.10 shows the results of Welch's t-test, which tests whether the difference in average growth between the two regions is statistically significant. The test results yield a p-value of 0.06229, slightly above the common threshold of 0.05. This means that the difference in growth is not statistically significant at the 5% level. However, this value is close to significance, suggesting that the difference may be significant, but the statistical evidence from this test is limited.




